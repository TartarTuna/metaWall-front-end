import{r as _,l as D,O as F,a as l,d as v,b as c,k as d,a3 as H,a6 as u,t as y,a5 as O,L as Q,P as b,f as G,Q as x,R as J,S as w,o as r,i as W,h as I,a7 as X}from"./index.628716c6.js";import{_ as Y}from"./PostFilter.c2d05629.js";import{E as L,_ as Z}from"./PostCard.929f9030.js";import{a as ee}from"./post.122b2d14.js";import{g as te,d as se,p as oe}from"./track.bab1f12b.js";import"./like.b6e08bb0.js";import"./day.22152a0f.js";import"./_commonjsHelpers.4e997714.js";import"./image.00ca4f9f.js";const ae={class:"container mt-7 px-lg-12 mb-12"},ne={class:"row"},ce={class:"col-lg-7"},re={class:"card mb-3 border8px border-2 cardDashBoard"},ie={key:0,class:"text-center",style:{"line-height":"88px"}},le={key:1,class:"row g-0 px-4"},de={class:"col-2 col-lg-1 align-self-center"},ue=["src"],me={class:"col-10 col-lg-11 d-flex justify-content-between"},pe={class:"card-body"},_e={class:"card-title fw-bold"},fe={class:"card-text"},ve={class:"text-muted"},he=W("\u8F09\u5165\u4E2D..."),ge={key:0,class:"ps-0"},Be={props:{userId:{type:String,required:!0}},setup(S){const i=S,h=_(!1),m=_(!1),g=_("desc"),P=_(""),f=_([]),a=_([]),U=D(()=>w.value._id===i.userId),k=D(()=>f.value.some(e=>e._id===i.userId)),C=async e=>{var t,s;try{h.value=!0,m.value=!0;const[o,n]=await Promise.all([te(),N(e)]);f.value=(s=(t=o.data)==null?void 0:t.tracking)!=null?s:[],a.value=n}finally{h.value=!1,m.value=!1}},E=async e=>{const{data:t}=await X(e);u.value=t},N=async e=>{const{data:t}=await ee(e,{createdAt:g.value,q:P.value});return t},B=async({reset:e=!1}={})=>{try{m.value=!0,e&&(a.value=[]);const t=await N(i.userId);a.value.push(...t)}finally{m.value=!1}},T=()=>{try{if(k.value){se(i.userId);const e=f.value.findIndex(t=>t._id===i.userId);f.value.splice(e,1),u.value.trackNum--}else oe(i.userId),f.value.push(u.value),u.value.trackNum++}catch(e){alert(e.message)}},R=e=>{a.value.find(s=>s._id===e).likes.push({_id:w.value._id})},V=e=>{const t=a.value.find(o=>o._id===e),s=t.likes.findIndex(o=>o._id===w.value._id);~s&&t.likes.splice(s,1)},M=({postId:e,comment:t})=>{a.value.find(o=>o._id===e).comments.push(t)},q=({postId:e,commentId:t,content:s})=>{const n=a.value.find(p=>p._id===e).comments.find(p=>p._id===t);n.content=s},K=({postId:e,commentId:t})=>{const s=a.value.find(n=>n._id===e),o=s.comments.findIndex(n=>n._id===t);~o&&s.comments.splice(o,1)},$=({postId:e,content:t,image:s})=>{const o=a.value.find(n=>n._id===e);o.content=t,o.image=s},j=e=>{const t=a.value.findIndex(s=>s._id===e);~t&&a.value.splice(t,1)},z=e=>{g.value=e,B({reset:!0})},A=e=>{P.value=e,B({reset:!0})};return F((e,t)=>{const{params:{userId:s}}=e;i.userId!==s&&(E(s),C(s))}),C(i.userId),(e,t)=>{const s=I("Navbar"),o=I("RightBar"),n=I("PhoneMenu");return r(),l(x,null,[v(s),c("section",ae,[c("div",ne,[c("div",ce,[c("div",re,[h.value?(r(),l("div",ie," \u8F09\u5165\u4E2D... ")):(r(),l("div",le,[c("div",de,[c("img",{src:d(H)(d(u).photo),class:"img-fluid rounded-start d-block m-auto",alt:"user6"},null,8,ue)]),c("div",me,[c("div",pe,[c("h5",_e,y(d(u).name),1),c("p",fe,[c("small",ve,y(d(u).trackNum)+" \u4EBA\u8FFD\u8E64",1)])]),d(U)?Q("",!0):(r(),l("button",{key:0,type:"button",class:O(["btn me-2 my-4 px-lg-5 border border-dark border-2 border8px shadow-pushcard d-block fw-bold",d(k)?"btn-gray-light":"btn-warning"]),onClick:T},y(d(k)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3))])]))]),v(Y,{loading:m.value,sort:g.value,onChangeSort:z,onChangeKeyword:A},null,8,["loading","sort"]),m.value?(r(),b(L,{key:0},{default:G(()=>[he]),_:1})):(r(),l(x,{key:1},[a.value.length?(r(),l("ul",ge,[(r(!0),l(x,null,J(a.value,p=>(r(),b(Z,{key:p._id,post:p,onPostLike:R,onDeleteLike:V,onPostComment:M,onEditComment:q,onDeleteComment:K,onEditPost:$,onDeletePost:j},null,8,["post"]))),128))])):(r(),b(L,{key:1}))],64))]),v(o)])]),v(n)],64)}}};export{Be as default};
