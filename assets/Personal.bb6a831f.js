import{r as _,m as D,P as F,a as l,d as f,b as c,l as d,a4 as H,a7 as u,t as y,a6 as Q,M as G,Q as b,g as J,R as x,S as O,T as w,o as r,j as W,i as I,a8 as X}from"./index.62789eef.js";import{_ as Y}from"./PostFilter.5c1aa6fa.js";import{E as S,_ as Z}from"./PostCard.d11389dc.js";import{a as ee}from"./post.d2c4a85d.js";import{g as te,d as se,p as oe}from"./track.d313090b.js";import"./like.624568bb.js";import"./day.22152a0f.js";import"./_commonjsHelpers.4e997714.js";import"./image.175e0650.js";const ae={class:"container mt-7 px-lg-12 mb-12"},ne={class:"row"},ce={class:"col-lg-7"},re={class:"card mb-3 border8px border-2 cardDashBoard"},ie={key:0,class:"text-center",style:{"line-height":"88px"}},le={key:1,class:"row g-0 px-4"},de={class:"col-2 col-lg-1 align-self-center"},ue=["src"],me={class:"col-10 col-lg-11 d-flex justify-content-between"},pe={class:"card-body"},_e={class:"card-title fw-bold"},ve={class:"card-text"},fe={class:"text-muted"},he=W("\u8F09\u5165\u4E2D..."),ge={key:0,class:"ps-0"},Be={props:{userId:{type:String,required:!0}},setup(L){const i=L,h=_(!1),m=_(!1),g=_("desc"),P=_(""),v=_([]),a=_([]),T=D(()=>w.value._id===i.userId),k=D(()=>v.value.some(e=>e._id===i.userId)),C=async e=>{var t,s;try{h.value=!0,m.value=!0;const[o,n]=await Promise.all([te(),N(e)]);v.value=(s=(t=o.data)==null?void 0:t.tracking)!=null?s:[],a.value=n}finally{h.value=!1,m.value=!1}},U=async e=>{const{data:t}=await X(e);u.value=t},N=async e=>{const{data:t}=await ee(e,{createdAt:g.value,q:P.value});return t},B=async({reset:e=!1}={})=>{try{m.value=!0,e&&(a.value=[]);const t=await N(i.userId);a.value.push(...t)}finally{m.value=!1}},E=()=>{try{if(k.value){se(i.userId);const e=v.value.findIndex(t=>t._id===i.userId);v.value.splice(e,1),u.value.trackNum--}else oe(i.userId),v.value.push(u.value),u.value.trackNum++}catch(e){alert(e.message)}},M=e=>{a.value.find(s=>s._id===e).likes.push({_id:w.value._id})},R=e=>{const t=a.value.find(o=>o._id===e),s=t.likes.findIndex(o=>o._id===w.value._id);~s&&t.likes.splice(s,1)},V=({postId:e,comment:t})=>{a.value.find(o=>o._id===e).comments.push(t)},j=({postId:e,commentId:t,content:s})=>{const n=a.value.find(p=>p._id===e).comments.find(p=>p._id===t);n.content=s},q=({postId:e,commentId:t})=>{const s=a.value.find(n=>n._id===e),o=s.comments.findIndex(n=>n._id===t);~o&&s.comments.splice(o,1)},K=({postId:e,content:t,image:s})=>{const o=a.value.find(n=>n._id===e);o.content=t,o.image=s},$=e=>{const t=a.value.findIndex(s=>s._id===e);~t&&a.value.splice(t,1)},z=e=>{g.value=e,B({reset:!0})},A=e=>{P.value=e,B({reset:!0})};return F((e,t)=>{const{params:{userId:s}}=e;i.userId!==s&&(U(s),C(s))}),C(i.userId),(e,t)=>{const s=I("Navbar"),o=I("RightBar"),n=I("PhoneMenu");return r(),l(x,null,[f(s),c("section",ae,[c("div",ne,[c("div",ce,[c("div",re,[h.value?(r(),l("div",ie," \u8F09\u5165\u4E2D... ")):(r(),l("div",le,[c("div",de,[c("img",{src:d(H)(d(u).photo),class:"img-fluid rounded-start d-block m-auto",alt:"user6"},null,8,ue)]),c("div",me,[c("div",pe,[c("h5",_e,y(d(u).name),1),c("p",ve,[c("small",fe,y(d(u).trackNum)+" \u4EBA\u8FFD\u8E64",1)])]),d(T)?G("",!0):(r(),l("button",{key:0,type:"button",class:Q(["btn me-2 my-4 px-lg-5 border border-dark border-2 border8px shadow-pushcard d-block fw-bold",d(k)?"btn-gray-light":"btn-warning"]),onClick:E},y(d(k)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3))])]))]),f(Y,{loading:m.value,sort:g.value,onChangeSort:z,onChangeKeyword:A},null,8,["loading","sort"]),m.value?(r(),b(S,{key:0},{default:J(()=>[he]),_:1})):(r(),l(x,{key:1},[a.value.length?(r(),l("ul",ge,[(r(!0),l(x,null,O(a.value,p=>(r(),b(Z,{key:p._id,post:p,onPostLike:M,onDeleteLike:R,onPostComment:V,onEditComment:j,onDeleteComment:q,onEditPost:K,onDeletePost:$},null,8,["post"]))),128))])):(r(),b(S,{key:1}))],64))]),f(o)])]),f(n)],64)}}};export{Be as default};
