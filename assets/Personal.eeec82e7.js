import{r as _,l as D,U as F,a as d,d as v,b as c,k as u,a2 as H,a5 as m,t as y,a4 as W,L as X,V as b,f as Y,W as x,X as G,Y as w,o as r,i as J,h as I,a6 as O}from"./index.2b65006e.js";import{_ as Q}from"./PostFilter.2ac958c0.js";import{E as L,_ as Z}from"./PostCard.9e787db5.js";import{a as ee}from"./post.e7252f34.js";import{g as te,d as se,p as oe}from"./track.5edefd57.js";import"./like.ac4e1f49.js";import"./day.22152a0f.js";import"./_commonjsHelpers.4e997714.js";import"./image.e045ad59.js";const ae={class:"container mt-7 px-lg-12 mb-12"},ne={class:"row"},ce={class:"col-lg-7"},re={class:"card mb-3 border8px border-2 cardDashBoard"},ie={key:0,class:"text-center",style:{"line-height":"88px"}},le={key:1,class:"row g-0 px-4"},de={class:"col-2 col-lg-1 align-self-center"},ue=["src"],me={class:"col-10 col-lg-11 d-flex justify-content-between"},pe={class:"card-body"},_e={class:"card-title fw-bold"},fe={class:"card-text"},ve={class:"text-muted"},he=J("\u8F09\u5165\u4E2D..."),ge={key:0,class:"ps-0"},Be={props:{userId:{type:String,required:!0}},setup(S){const i=S,h=_(!1),p=_(!1),g=_("desc"),C=_(""),f=_([]),a=_([]),U=D(()=>w.value._id===i.userId),k=D(()=>f.value.some(e=>e._id===i.userId)),P=async e=>{var t,s;try{h.value=!0,p.value=!0;const[o,n]=await Promise.all([te(),N(e)]);f.value=(s=(t=o.data)==null?void 0:t.tracking)!=null?s:[],a.value=n}finally{h.value=!1,p.value=!1}},E=async e=>{const{data:t}=await O(e);m.value=t},N=async e=>{const{data:t}=await ee(e,{createdAt:g.value,q:C.value});return t},B=async({reset:e=!1}={})=>{try{p.value=!0,e&&(a.value=[]);const t=await N(i.userId);a.value.push(...t)}finally{p.value=!1}},T=()=>{try{if(k.value){se(i.userId);const e=f.value.findIndex(t=>t._id===i.userId);f.value.splice(e,1),m.value.trackNum--}else oe(i.userId),f.value.push(m.value),m.value.trackNum++}catch(e){alert(e.message)}},V=e=>{a.value.find(s=>s._id===e).likes.push({_id:w.value._id})},M=e=>{const t=a.value.find(o=>o._id===e),s=t.likes.findIndex(o=>o._id===w.value._id);~s&&t.likes.splice(s,1)},R=({postId:e,comment:t})=>{a.value.find(o=>o._id===e).comments.push(t)},q=({postId:e,commentId:t,content:s})=>{const n=a.value.find(l=>l._id===e).comments.find(l=>l._id===t);n.content=s},K=({postId:e,commentId:t})=>{const s=a.value.find(n=>n._id===e),o=s.comments.findIndex(n=>n._id===t);~o&&s.comments.splice(o,1)},$=({postId:e,content:t,image:s,tag:o})=>{const n=a.value.find(l=>l._id===e);n.content=t,n.tag=o,n.image=s},j=e=>{const t=a.value.findIndex(s=>s._id===e);~t&&a.value.splice(t,1)},z=e=>{g.value=e,B({reset:!0})},A=e=>{C.value=e,B({reset:!0})};return F((e,t)=>{const{params:{userId:s}}=e;i.userId!==s&&(E(s),P(s))}),P(i.userId),(e,t)=>{const s=I("Navbar"),o=I("RightBar"),n=I("PhoneMenu");return r(),d(x,null,[v(s),c("section",ae,[c("div",ne,[c("div",ce,[c("div",re,[h.value?(r(),d("div",ie," \u8F09\u5165\u4E2D... ")):(r(),d("div",le,[c("div",de,[c("img",{src:u(H)(u(m).photo),class:"img-fluid rounded-start d-block m-auto",alt:"user6"},null,8,ue)]),c("div",me,[c("div",pe,[c("h5",_e,y(u(m).name),1),c("p",fe,[c("small",ve,y(u(m).trackNum)+" \u4EBA\u8FFD\u8E64",1)])]),u(U)?X("",!0):(r(),d("button",{key:0,type:"button",class:W(["btn me-2 my-4 px-lg-5 border border-dark border-2 border8px shadow-pushcard d-block fw-bold",u(k)?"btn-gray-light":"btn-warning"]),onClick:T},y(u(k)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3))])]))]),v(Q,{loading:p.value,sort:g.value,onChangeSort:z,onChangeKeyword:A},null,8,["loading","sort"]),p.value?(r(),b(L,{key:0},{default:Y(()=>[he]),_:1})):(r(),d(x,{key:1},[a.value.length?(r(),d("ul",ge,[(r(!0),d(x,null,G(a.value,l=>(r(),b(Z,{key:l._id,post:l,onPostLike:V,onDeleteLike:M,onPostComment:R,onEditComment:q,onDeleteComment:K,onEditPost:$,onDeletePost:j},null,8,["post"]))),128))])):(r(),b(L,{key:1}))],64))]),v(o)])]),v(n)],64)}}};export{Be as default};
