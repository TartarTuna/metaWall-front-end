import{r as o,a as d,d as c,b as s,w as x,e as k,v as F,t as g,M as f,f as C,O as j,h as P,o as u,Y as B,Z as D,$ as M,j as N}from"./index.32f4ca47.js";import{p as V}from"./image.21964900.js";import{b as $}from"./post.7857bc31.js";const T={class:"container mt-7 px-lg-12 mb-12"},G={class:"row"},I={class:"col-lg-7"},U=s("div",{class:"card mb-5 rounded-0 border-2 titleDashBoard"},[s("h2",{class:"text-center fw-bold py-3 mb-0 fs-5"},"\u5F35\u8CBC\u52D5\u614B")],-1),E={class:"card border border-dark border-2 shadow-pushcard border8px p-5"},J={class:"form-group mb-3"},L=s("label",{for:"content fw-bold"},"\u8CBC\u6587\u5167\u5BB9",-1),O={key:0,class:"my-0 text-center fs-7 text-danger"},R={class:"mb-3"},S=["src"],A={key:2,class:"my-0 text-center fs-7 text-danger"},H={class:"d-grid gap-2 col-8 mx-auto mt-5"},Y=N(" \u9001\u51FA\u8CBC\u6587 "),Q={setup(Z){const i=o(!1),l=o(null),m=o(null),b=o(["jpg","jpeg","JPG","JPEG","png","PNG"]),n=o(null),p=o(!1),a=o({src:"",imgFile:null}),_=e=>{n.value="";const t=e.target.files[0],v=t.type.split("/")[1];if(!y(v)){n.value="\u6A94\u6848\u683C\u5F0F\u932F\u8AA4\uFF0C\u50C5\u9650\u4E0A\u50B3 jpg\u3001jpeg \u8207 png \u683C\u5F0F",m.value="";return}const r=new FileReader;r.readAsDataURL(t),r.onload=()=>{a.value.src=r.result,a.value.imgFile=t}},y=e=>!!b.value.includes(e),h=async()=>{try{const e=new FormData;e.append("image",a.value.imgFile);const{data:{imageUrl:t=""}}=await V(e);return t}catch(e){return Promise.reject(e)}},w=async()=>{if(i.value=!0,p.value=!1,n.value="",!l.value){p.value=!0,i.value=!1;return}try{let e="";a.value.imgFile&&(e=await h());const t={content:l.value};e&&(t.image=e),await $(t),alert("\u65B0\u589E\u6210\u529F"),l.value=null,m.value="",a.value.imgFile=null,a.value.src=null}catch(e){console.log(e),alert(e.message)}finally{i.value=!1}};return(e,t)=>{const v=P("Button");return u(),d(j,null,[c(B),s("section",T,[s("div",G,[s("div",I,[U,s("div",E,[s("form",{onSubmit:t[2]||(t[2]=x(()=>{},["prevent"]))},[s("div",J,[L,k(s("textarea",{"onUpdate:modelValue":t[0]||(t[0]=r=>l.value=r),class:"form-control border border-dark border-2",type:"text",id:"content",rows:"5",placeholder:"\u8F38\u5165\u60A8\u7684\u8CBC\u6587\u5167\u5BB9"},null,512),[[F,l.value]])]),p.value&&!l.value?(u(),d("div",O,g("\u8ACB\u586B\u5BEB\u8CBC\u6587\u5167\u5BB9"))):f("",!0),s("div",R,[s("input",{ref_key:"inputFile",ref:m,type:"file",class:"d-none",placeholder:"\u4E0A\u50B3\u5716\u7247",onChange:_},null,544),s("button",{class:"btn btn-dark border",style:{"border-radius":"8px"},onClick:t[1]||(t[1]=r=>e.$refs.inputFile.click())}," \u4E0A\u50B3\u5716\u7247 ")]),a.value.src?(u(),d("img",{key:1,src:a.value.src,alt:"photo",class:"w-100 img-fluid mb-2"},null,8,S)):f("",!0),n.value?(u(),d("div",A,g(n.value),1)):f("",!0),s("div",H,[c(v,{class:"btn btn-gray-dark border border-dark border-2 fw-bold py-3 border8px",type:"submit",loading:i.value,onClick:w},{default:C(()=>[Y]),_:1},8,["loading"])])],32)])]),c(D)])]),c(M)],64)}}};export{Q as default};
